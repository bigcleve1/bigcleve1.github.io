<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>526给王 - 稳定版</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background-color: #050505; 
            user-select: none; 
            touch-action: none; 
        }
        canvas { display: block; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    [span_2](start_span)const ctx = canvas.getContext('2d', { alpha: false });[span_2](end_span)

    [span_3](start_span)let texts = [];[span_3](end_span)
    [span_4](start_span)let particles = [];[span_4](end_span)
    [span_5](start_span)let shakeTime = 0;[span_5](end_span)
    [span_6](start_span)let bgOverlay = 0;[span_6](end_span)

    [span_7](start_span)const names = ["董佳琦", "翟利杰", "李子奥", "王浩瑞", "杜英达", "燕奕轩", "徐浩伦", "温祖国", "尚淼晨", "冯天乐", "谷禹龙", "田星", "王烨阳", "庞逸桐", "王晨骁"];[span_7](end_span)

    function resize() {
        [span_8](start_span)canvas.width = window.innerWidth;[span_8](end_span)
        [span_9](start_span)canvas.height = window.innerHeight;[span_9](end_span)
    }
    window.addEventListener('resize', resize);
    resize();

    class Particle {
        constructor(x, y, hue, forceScale = 1) {
            [span_10](start_span)this.x = x;[span_10](end_span)
            [span_11](start_span)this.y = y;[span_11](end_span)
            [span_12](start_span)this.hue = hue;[span_12](end_span)
            [span_13](start_span)this.size = Math.random() * 4 + 2;[span_13](end_span)
            [span_14](start_span)const angle = Math.random() * Math.PI * 2;[span_14](end_span)
            [span_15](start_span)const force = (Math.random() * 6 + 4) * forceScale;[span_15](end_span)
            [span_16](start_span)this.vx = Math.cos(angle) * force;[span_16](end_span)
            [span_17](start_span)this.vy = Math.sin(angle) * force;[span_17](end_span)
            [span_18](start_span)this.life = 1.0;[span_18](end_span)
            [span_19](start_span)this.decay = Math.random() * 0.02 + 0.015;[span_19](end_span)
            [span_20](start_span)this.gravity = 0.15;[span_20](end_span)
        }
        update() {
            [span_21](start_span)this.vx *= 0.96;[span_21](end_span)
            [span_22](start_span)this.vy *= 0.96;[span_22](end_span)
            [span_23](start_span)this.vy += this.gravity;[span_23](end_span)
            [span_24](start_span)this.x += this.vx;[span_24](end_span)
            [span_25](start_span)this.y += this.vy;[span_25](end_span)
            [span_26](start_span)this.life -= this.decay;[span_26](end_span)
        }
        draw() {
            [span_27](start_span)if (this.life <= 0) return;[span_27](end_span)
            [span_28](start_span)ctx.fillStyle = `hsla(${this.hue}, 100%, 70%, ${this.life})`;[span_28](end_span)
            ctx.beginPath();
            [span_29](start_span)ctx.arc(this.x, this.y, this.size * this.life, 0, Math.PI * 2);[span_29](end_span)
            ctx.fill();
        }
    }

    class FlyingText {
        constructor(x, y, name, level = 1) {
            [span_30](start_span)this.x = x;[span_30](end_span)
            [span_31](start_span)this.y = y;[span_31](end_span)
            [span_32](start_span)this.name = name;[span_32](end_span)
            [span_33](start_span)this.content = name + "是给";[span_33](end_span)
            [span_34](start_span)this.level = level;[span_34](end_span)
            [span_35](start_span)this.vx = (Math.random() - 0.5) * (6 + level);[span_35](end_span)
            [span_36](start_span)this.vy = (Math.random() - 0.5) * (6 + level);[span_36](end_span)
            [span_37](start_span)this.hue = Math.random() * 360;[span_37](end_span)
            [span_38](start_span)this.baseSize = 22 + (this.level - 1) * 8;[span_38](end_span)
            [span_39](start_span)this.scale = 2.0;[span_39](end_span)
            [span_40](start_span)this.toRemove = false;[span_40](end_span)
            this.updateMetrics();
        }

        updateMetrics() {
            [span_41](start_span)ctx.font = `bold ${this.baseSize}px "Microsoft YaHei"`;[span_41](end_span)
            [span_42](start_span)this.width = ctx.measureText(this.content).width;[span_42](end_span)
        }

        update() {
            [span_43](start_span)this.x += this.vx;[span_43](end_span)
            [span_44](start_span)this.y += this.vy;[span_44](end_span)
            [span_45](start_span)if (this.scale > 1) this.scale -= 0.1;[span_45](end_span)
            
            // 碰撞边界反弹
            if (this.x <= 0) { this.vx *= -1; this.x = 0; this.onHit(); [span_46](start_span)}
            if (this.x >= canvas.width - this.width) { this.vx *= -1; this.x = canvas.width - this.width; this.onHit(); }[span_46](end_span)
            if (this.y <= this.baseSize) { this.vy *= -1; this.y = this.baseSize; this.onHit(); [span_47](start_span)}
            if (this.y >= canvas.height) { this.vy *= -1; this.y = canvas.height; this.onHit(); }[span_47](end_span)
            
            [span_48](start_span)this.hue = (this.hue + 1) % 360;[span_48](end_span)
        }

        onHit() {
            [span_49](start_span)shakeTime = 2;[span_49](end_span)
            [span_50](start_span)particles.push(new Particle(this.x + this.width / 2, this.y, this.hue));[span_50](end_span)
        }

        draw() {
            [span_51](start_span)ctx.save();[span_51](end_span)
            [span_52](start_span)ctx.translate(this.x, this.y);[span_52](end_span)
            [span_53](start_span)ctx.scale(this.scale, this.scale);[span_53](end_span)
            [span_54](start_span)const color = `hsl(${this.hue}, 100%, 75%)`;[span_54](end_span)
            [span_55](start_span)ctx.font = `bold ${this.baseSize}px "Microsoft YaHei"`;[span_55](end_span)
            [span_56](start_span)ctx.shadowBlur = 10 + this.level * 2;[span_56](end_span)
            [span_57](start_span)ctx.shadowColor = color;[span_57](end_span)
            [span_58](start_span)ctx.fillStyle = color;[span_58](end_span)
            [span_59](start_span)ctx.fillText(this.content, 0, 0);[span_59](end_span)
            [span_60](start_span)ctx.restore();[span_60](end_span)
        }
    }

    function handleAction(e) {
        // 兼容 PC 和 手机
        [span_61](start_span)const x = (e.clientX || (e.touches && e.touches[0].clientX));[span_61](end_span)
        [span_62](start_span)const y = (e.clientY || (e.touches && e.touches[0].clientY));[span_62](end_span)
        [span_63](start_span)if (!x || !y) return;[span_63](end_span)

        [span_64](start_span)const name = names[Math.floor(Math.random() * names.length)];[span_64](end_span)
        [span_65](start_span)texts.push(new FlyingText(x, y, name));[span_65](end_span)
        
        // 初始喷发粒子
        [span_66](start_span)for(let i=0; i<10; i++) particles.push(new Particle(x, y, Math.random()*360));[span_66](end_span)
        [span_67](start_span)bgOverlay = 0.05;[span_67](end_span)
    }

    // 监听交互
    [span_68](start_span)canvas.addEventListener('mousedown', handleAction);[span_68](end_span)
    canvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        handleAction(e);
    [span_69](start_span)}, { passive: false });[span_69](end_span)

    function checkSynthesis() {
        for (let i = 0; i < texts.length; i++) {
            for (let j = i + 1; j < texts.length; j++) {
                [span_70](start_span)let t1 = texts[i];[span_70](end_span)
                [span_71](start_span)let t2 = texts[j];[span_71](end_span)
                [span_72](start_span)if (!t1.toRemove && !t2.toRemove && t1.name === t2.name) {[span_72](end_span)
                    [span_73](start_span)const dx = (t1.x + t1.width / 2) - (t2.x + t2.width / 2);[span_73](end_span)
                    [span_74](start_span)const dy = (t1.y - t1.baseSize / 2) - (t2.y - t2.baseSize / 2);[span_74](end_span)
                    [span_75](start_span)const dist = Math.sqrt(dx * dx + dy * dy);[span_75](end_span)
                    
                    // 碰撞距离判定
                    [span_76](start_span)if (dist < (t1.width + t2.width) / 3) {[span_76](end_span)
                        [span_77](start_span)t1.toRemove = true;[span_77](end_span)
                        [span_78](start_span)t2.toRemove = true;[span_78](end_span)
                        [span_79](start_span)const nextLevel = Math.max(t1.level, t2.level) + 1;[span_79](end_span)
                        
                        // 合成新文本
                        setTimeout(() => {
                            [span_80](start_span)texts.push(new FlyingText((t1.x + t2.x)/2, (t1.y + t2.y)/2, t1.name, nextLevel));[span_80](end_span)
                        }, 10);
                        
                        // 合成特效
                        [span_81](start_span)shakeTime = 10;[span_81](end_span)
                        [span_82](start_span)bgOverlay = 0.2;[span_82](end_span)
                        for (let k = 0; k < 30; k++) {
                            [span_83](start_span)particles.push(new Particle((t1.x + t2.x)/2, (t1.y + t2.y)/2, t1.hue, 1.5));[span_83](end_span)
                        }
                    }
                }
            }
        }
        [span_84](start_span)texts = texts.filter(t => !t.toRemove);[span_84](end_span)
    }

    function animate() {
        [span_85](start_span)ctx.save();[span_85](end_span)
        
        // 震动逻辑
        if (shakeTime > 0) {
            [span_86](start_span)ctx.translate((Math.random()-0.5)*shakeTime, (Math.random()-0.5)*shakeTime);[span_86](end_span)
            [span_87](start_span)shakeTime--;[span_87](end_span)
        }

        // 绘制背景
        [span_88](start_span)ctx.fillStyle = '#050505';[span_88](end_span)
        [span_89](start_span)ctx.fillRect(0, 0, canvas.width, canvas.height);[span_89](end_span)
        
        // 拖尾感
        [span_90](start_span)ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';[span_90](end_span)
        [span_91](start_span)ctx.fillRect(0, 0, canvas.width, canvas.height);[span_91](end_span)

        // 闪白特效
        if (bgOverlay > 0) {
            [span_92](start_span)ctx.fillStyle = `rgba(255, 255, 255, ${bgOverlay})`;[span_92](end_span)
            [span_93](start_span)ctx.fillRect(0, 0, canvas.width, canvas.height);[span_93](end_span)
            [span_94](start_span)bgOverlay -= 0.01;[span_94](end_span)
        }

        // 逻辑更新
        [span_95](start_span)checkSynthesis();[span_95](end_span)
        
        [span_96](start_span)particles = particles.filter(p => p.life > 0);[span_96](end_span)
        [span_97](start_span)particles.forEach(p => { p.update(); p.draw(); });[span_97](end_span)
        
        [span_98](start_span)texts.forEach(t => { t.update(); t.draw(); });[span_98](end_span)

        [span_99](start_span)ctx.restore();[span_99](end_span)
        [span_100](start_span)requestAnimationFrame(animate);[span_100](end_span)
    }

    animate();
</script>
</body>
</html>
